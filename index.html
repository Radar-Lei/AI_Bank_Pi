<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智银派授信报告智能填写系统</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans SC -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- PizZip & Docxtemplater -->
    <script src="https://cdn.jsdelivr.net/npm/pizzip@3.1.7/dist/pizzip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docxtemplater@3.47.1/build/docxtemplater.min.js"></script>
    
    <!-- SheetJS for Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <!-- FileSaver -->
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        },
                        accent: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75',
                        },
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                    },
                    fontFamily: {
                        sans: ['Noto Sans SC', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'gradient': 'gradient 8s ease infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        gradient: {
                            '0%, 100%': { backgroundPosition: '0% 50%' },
                            '50%': { backgroundPosition: '100% 50%' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                    },
                }
            }
        }
    </script>
    
    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Gradient background */
        .gradient-bg {
            background: linear-gradient(-45deg, #1e3a8a, #3b82f6, #8b5cf6, #d946ef);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        
        /* Glass morphism */
        .glass {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        /* Step animations */
        .step-content {
            display: none;
            opacity: 0;
            transform: translateX(20px);
            transition: all 0.3s ease;
        }
        .step-content.active {
            display: block;
            opacity: 1;
            transform: translateX(0);
        }
        
        /* File drop area hover effect */
        .file-drop-area {
            transition: all 0.3s ease;
            border: 2px dashed #cbd5e1;
        }
        .file-drop-area:hover, .file-drop-area.dragover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
            transform: scale(1.01);
        }
        
        /* Button hover effects */
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(37, 99, 235, 0.3);
        }
        
        /* Loading spinner */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Tab styles */
        .tab-btn {
            position: relative;
            transition: all 0.3s ease;
        }
        .tab-btn::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            transition: all 0.3s ease;
            transform: translateX(-50%);
            border-radius: 3px 3px 0 0;
        }
        .tab-btn.active::after {
            width: 100%;
        }
        .tab-btn.active {
            color: #3b82f6;
        }
        
        /* Card hover effect */
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        /* Toast notification */
        .toast {
            transform: translateX(120%);
            transition: transform 0.3s ease;
        }
        .toast.show {
            transform: translateX(0);
        }
        
        /* Progress bar */
        .progress-fill {
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="min-h-screen gradient-bg">
    <!-- Header -->
    <header class="glass sticky top-0 z-50 shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-primary-500 to-accent-500 flex items-center justify-center shadow-lg">
                        <i class="fa fa-bank text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800">智银派授信报告智能填写系统</h1>
                        <p class="text-sm text-gray-500">AI-Powered Credit Report Generator</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <button id="settingsBtn" class="p-2 rounded-lg hover:bg-gray-100 transition-colors" title="API设置">
                        <i class="fa fa-cog text-gray-600 text-lg"></i>
                    </button>
                    <button id="helpBtn" class="p-2 rounded-lg hover:bg-gray-100 transition-colors" title="帮助">
                        <i class="fa fa-question-circle text-gray-600 text-lg"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Step Indicator -->
        <div class="glass rounded-2xl p-6 mb-8 shadow-xl">
            <div class="flex items-center justify-between max-w-3xl mx-auto">
                <!-- Step 1 -->
                <div class="flex flex-col items-center">
                    <div id="step1-indicator" class="w-12 h-12 rounded-full bg-gradient-to-br from-primary-500 to-primary-600 text-white flex items-center justify-center font-bold text-lg shadow-lg transition-all duration-300">
                        1
                    </div>
                    <span class="mt-2 text-sm font-medium text-gray-700">上传材料</span>
                </div>
                
                <!-- Line 1-2 -->
                <div class="flex-1 h-1 mx-4 rounded-full bg-gray-200 overflow-hidden">
                    <div id="line1-2" class="h-full bg-gradient-to-r from-primary-500 to-primary-600 transition-all duration-500" style="width: 0%"></div>
                </div>
                
                <!-- Step 2 -->
                <div class="flex flex-col items-center">
                    <div id="step2-indicator" class="w-12 h-12 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-bold text-lg transition-all duration-300">
                        2
                    </div>
                    <span class="mt-2 text-sm font-medium text-gray-500">信息确认</span>
                </div>
                
                <!-- Line 2-3 -->
                <div class="flex-1 h-1 mx-4 rounded-full bg-gray-200 overflow-hidden">
                    <div id="line2-3" class="h-full bg-gradient-to-r from-primary-500 to-primary-600 transition-all duration-500" style="width: 0%"></div>
                </div>
                
                <!-- Step 3 -->
                <div class="flex flex-col items-center">
                    <div id="step3-indicator" class="w-12 h-12 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-bold text-lg transition-all duration-300">
                        3
                    </div>
                    <span class="mt-2 text-sm font-medium text-gray-500">文本填写</span>
                </div>
                
                <!-- Line 3-4 -->
                <div class="flex-1 h-1 mx-4 rounded-full bg-gray-200 overflow-hidden">
                    <div id="line3-4" class="h-full bg-gradient-to-r from-primary-500 to-primary-600 transition-all duration-500" style="width: 0%"></div>
                </div>
                
                <!-- Step 4 -->
                <div class="flex flex-col items-center">
                    <div id="step4-indicator" class="w-12 h-12 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-bold text-lg transition-all duration-300">
                        4
                    </div>
                    <span class="mt-2 text-sm font-medium text-gray-500">生成报告</span>
                </div>
            </div>
        </div>

        <!-- Step Contents -->
        <div class="max-w-5xl mx-auto">
            <!-- Step 1: Upload Materials -->
            <div id="step1-content" class="step-content active">
                <div class="glass rounded-2xl p-8 shadow-xl card-hover">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">上传授信报告材料</h2>
                        <p class="text-gray-500">请上传以下材料，系统将自动提取信息并填写到授信报告模板中</p>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Template Upload -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fa fa-file-word-o text-primary-500 mr-2"></i>
                                1. 授信报告模板 (Word文档)
                            </label>
                            <div id="templateDropArea" class="file-drop-area rounded-xl p-8 cursor-pointer bg-gray-50">
                                <div class="flex flex-col items-center">
                                    <div class="w-16 h-16 rounded-full bg-primary-100 flex items-center justify-center mb-4">
                                        <i class="fa fa-file-word-o text-3xl text-primary-500"></i>
                                    </div>
                                    <p class="text-gray-600 mb-1">点击或拖拽文件到此处上传</p>
                                    <p class="text-sm text-gray-400">支持 .docx 格式</p>
                                </div>
                                <input type="file" id="templateFile" class="hidden" accept=".docx">
                            </div>
                            <div id="templateFileInfo" class="mt-3 hidden">
                                <div class="flex items-center justify-between bg-primary-50 rounded-lg p-3 border border-primary-200">
                                    <div class="flex items-center gap-3">
                                        <i class="fa fa-file-word-o text-primary-500 text-xl"></i>
                                        <span id="templateFileName" class="text-sm font-medium text-gray-700 truncate max-w-xs"></span>
                                    </div>
                                    <button id="removeTemplateFile" class="text-gray-400 hover:text-danger transition-colors">
                                        <i class="fa fa-times-circle text-lg"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Financial Reports Upload -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fa fa-file-excel-o text-success mr-2"></i>
                                2. 财务报表 (Excel表格)
                            </label>
                            <div id="financialDropArea" class="file-drop-area rounded-xl p-8 cursor-pointer bg-gray-50">
                                <div class="flex flex-col items-center">
                                    <div class="w-16 h-16 rounded-full bg-green-100 flex items-center justify-center mb-4">
                                        <i class="fa fa-file-excel-o text-3xl text-success"></i>
                                    </div>
                                    <p class="text-gray-600 mb-1">点击或拖拽文件到此处上传</p>
                                    <p class="text-sm text-gray-400">支持 .xlsx, .xls 格式（可多选）</p>
                                </div>
                                <input type="file" id="financialFile" class="hidden" accept=".xlsx,.xls" multiple>
                            </div>
                            <div id="financialFileInfo" class="mt-3 hidden">
                                <div class="flex items-center justify-between bg-green-50 rounded-lg p-3 border border-green-200">
                                    <div class="flex items-center gap-3">
                                        <i class="fa fa-file-excel-o text-success text-xl"></i>
                                        <span id="financialFileName" class="text-sm font-medium text-gray-700 truncate max-w-xs"></span>
                                    </div>
                                    <button id="removeFinancialFile" class="text-gray-400 hover:text-danger transition-colors">
                                        <i class="fa fa-times-circle text-lg"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Business Info Upload -->
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">
                                <i class="fa fa-file-image-o text-accent-500 mr-2"></i>
                                3. 工商信息截图 (图片/PDF)
                            </label>
                            <div id="businessDropArea" class="file-drop-area rounded-xl p-8 cursor-pointer bg-gray-50">
                                <div class="flex flex-col items-center">
                                    <div class="w-16 h-16 rounded-full bg-accent-100 flex items-center justify-center mb-4">
                                        <i class="fa fa-file-image-o text-3xl text-accent-500"></i>
                                    </div>
                                    <p class="text-gray-600 mb-1">点击或拖拽文件到此处上传</p>
                                    <p class="text-sm text-gray-400">支持 .jpg, .png, .pdf 格式</p>
                                </div>
                                <input type="file" id="businessFile" class="hidden" accept=".jpg,.jpeg,.png,.pdf">
                            </div>
                            <div id="businessFileInfo" class="mt-3 hidden">
                                <div class="flex items-center justify-between bg-accent-50 rounded-lg p-3 border border-accent-200">
                                    <div class="flex items-center gap-3">
                                        <i class="fa fa-file-image-o text-accent-500 text-xl"></i>
                                        <span id="businessFileName" class="text-sm font-medium text-gray-700 truncate max-w-xs"></span>
                                    </div>
                                    <button id="removeBusinessFile" class="text-gray-400 hover:text-danger transition-colors">
                                        <i class="fa fa-times-circle text-lg"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8 flex justify-end">
                        <button id="toStep2Btn" class="btn-primary text-white px-8 py-3 rounded-xl font-semibold flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none" disabled>
                            <span>下一步：信息确认</span>
                            <i class="fa fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 2: Information Confirmation -->
            <div id="step2-content" class="step-content">
                <div class="glass rounded-2xl p-8 shadow-xl">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">信息确认</h2>
                        <p class="text-gray-500">请确认从上传材料中提取的信息，如有错误请修改</p>
                    </div>
                    
                    <!-- Company Info Section -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <i class="fa fa-building text-primary-500"></i>
                            企业基本信息
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">企业名称 <span class="text-danger">*</span></label>
                                <input type="text" id="companyName" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入企业名称">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">统一社会信用代码 <span class="text-danger">*</span></label>
                                <input type="text" id="creditCode" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入统一社会信用代码">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">法定代表人 <span class="text-danger">*</span></label>
                                <input type="text" id="legalRep" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入法定代表人">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">注册资本 <span class="text-danger">*</span></label>
                                <input type="text" id="registeredCapital" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入注册资本">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">成立日期 <span class="text-danger">*</span></label>
                                <input type="date" id="establishDate" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">所属行业 <span class="text-danger">*</span></label>
                                <input type="text" id="industry" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入所属行业">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">企业规模</label>
                                <select id="companySize" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all">
                                    <option value="">请选择</option>
                                    <option value="大型">大型</option>
                                    <option value="中型">中型</option>
                                    <option value="小型">小型</option>
                                    <option value="微型">微型</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">员工人数</label>
                                <input type="text" id="employeeCount" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入员工人数">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-600 mb-1">注册地址 <span class="text-danger">*</span></label>
                                <input type="text" id="registeredAddress" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入注册地址">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-600 mb-1">经营范围</label>
                                <textarea id="businessScope" rows="3" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请输入经营范围"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Financial Info Section -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <i class="fa fa-line-chart text-success"></i>
                            财务信息
                        </h3>
                        <div class="overflow-x-auto">
                            <table class="w-full border-collapse">
                                <thead>
                                    <tr class="bg-gray-50">
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700 border-b">项目</th>
                                        <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700 border-b">上年末</th>
                                        <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700 border-b">年初</th>
                                        <th class="px-4 py-3 text-right text-sm font-semibold text-gray-700 border-b">本期末</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="px-4 py-3 text-sm text-gray-700 border-b">资产总额 (万元)</td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="totalAssetsLastYear" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="totalAssetsBeginning" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="totalAssetsEnd" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 text-sm text-gray-700 border-b">负债总额 (万元)</td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="totalLiabilitiesLastYear" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="totalLiabilitiesBeginning" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="totalLiabilitiesEnd" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 text-sm text-gray-700 border-b">所有者权益 (万元)</td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="ownerEquityLastYear" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="ownerEquityBeginning" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="ownerEquityEnd" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 text-sm text-gray-700 border-b">营业收入 (万元)</td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="revenueLastYear" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b text-center text-gray-400">-</td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="revenueCurrent" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 text-sm text-gray-700 border-b">净利润 (万元)</td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="netProfitLastYear" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b text-center text-gray-400">-</td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="netProfitCurrent" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3 text-sm text-gray-700 border-b">资产负债率 (%)</td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="debtRatioLastYear" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="debtRatioBeginning" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                        <td class="px-4 py-3 border-b"><input type="text" id="debtRatioEnd" class="w-full px-2 py-1 text-right border border-gray-200 rounded focus:ring-2 focus:ring-primary-500 focus:border-transparent" placeholder="0.00"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Credit Info Section -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <i class="fa fa-credit-card text-accent-500"></i>
                            授信信息
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">授信类型</label>
                                <select id="creditType" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all">
                                    <option value="">请选择</option>
                                    <option value="流动资金贷款">流动资金贷款</option>
                                    <option value="固定资产贷款">固定资产贷款</option>
                                    <option value="项目融资">项目融资</option>
                                    <option value="银行承兑汇票">银行承兑汇票</option>
                                    <option value="信用证">信用证</option>
                                    <option value="保函">保函</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">授信金额 (万元)</label>
                                <input type="text" id="creditAmount" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入授信金额">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">授信期限 (月)</label>
                                <input type="text" id="creditPeriod" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入授信期限">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">授信用途</label>
                                <input type="text" id="creditPurpose" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入授信用途">
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between">
                        <button id="backToStep1Btn" class="px-6 py-3 rounded-xl font-semibold text-gray-600 hover:bg-gray-100 transition-colors flex items-center gap-2">
                            <i class="fa fa-arrow-left"></i>
                            <span>上一步</span>
                        </button>
                        <button id="toStep3Btn" class="btn-primary text-white px-8 py-3 rounded-xl font-semibold flex items-center gap-2">
                            <span>下一步：文本填写</span>
                            <i class="fa fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 3: Text Filling -->
            <div id="step3-content" class="step-content">
                <div class="glass rounded-2xl p-8 shadow-xl">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">授信报告文本填写</h2>
                        <p class="text-gray-500">请填写以下授信报告文本内容，或点击"AI智能生成"自动生成</p>
                    </div>
                    
                    <!-- Tabs -->
                    <div class="border-b border-gray-200 mb-6">
                        <div class="flex gap-1 overflow-x-auto">
                            <button class="tab-btn active px-6 py-3 text-sm font-medium text-gray-600 whitespace-nowrap" data-tab="overview">企业概况</button>
                            <button class="tab-btn px-6 py-3 text-sm font-medium text-gray-600 whitespace-nowrap" data-tab="businessAnalysis">经营分析</button>
                            <button class="tab-btn px-6 py-3 text-sm font-medium text-gray-600 whitespace-nowrap" data-tab="financialAnalysis">财务分析</button>
                            <button class="tab-btn px-6 py-3 text-sm font-medium text-gray-600 whitespace-nowrap" data-tab="riskAnalysis">风险分析</button>
                            <button class="tab-btn px-6 py-3 text-sm font-medium text-gray-600 whitespace-nowrap" data-tab="conclusion">结论与建议</button>
                        </div>
                    </div>
                    
                    <!-- Tab Contents -->
                    <div id="tab-overview" class="tab-content">
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">1.1 企业基本情况</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="basicSituation">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="basicSituation" rows="6" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请详细描述企业的历史沿革、组织架构、股权结构、主营业务等基本情况"></textarea>
                            </div>
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">1.2 实际控制人情况</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="controllerSituation">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="controllerSituation" rows="4" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请描述实际控制人的背景、从业经验、个人信用状况等"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div id="tab-businessAnalysis" class="tab-content hidden">
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">2.1 经营状况</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="businessStatus">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="businessStatus" rows="6" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请详细描述企业近三年的经营状况，包括主要产品或服务、生产规模、销售情况等"></textarea>
                            </div>
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">2.2 市场分析</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="marketAnalysis">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="marketAnalysis" rows="4" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请分析企业所处行业的发展趋势、市场规模、竞争格局等"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div id="tab-financialAnalysis" class="tab-content hidden">
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">3.1 财务状况概述</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="financialOverview">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="financialOverview" rows="6" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请对企业近三年的财务状况进行概述，包括资产负债结构、盈利能力、偿债能力等"></textarea>
                            </div>
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">3.2 关键财务指标分析</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="financialIndicators">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="financialIndicators" rows="4" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请对资产负债率、流动比率、速动比率、净资产收益率等关键财务指标进行分析"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div id="tab-riskAnalysis" class="tab-content hidden">
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">4.1 信用风险</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="creditRisk">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="creditRisk" rows="4" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请分析企业的信用风险，包括还款意愿、还款能力、历史信用记录等"></textarea>
                            </div>
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">4.2 市场风险</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="marketRisk">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="marketRisk" rows="4" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请分析企业面临的市场风险，包括行业周期、市场竞争、价格波动等"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div id="tab-conclusion" class="tab-content hidden">
                        <div class="space-y-4">
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">5.1 总体评价</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="overallEvaluation">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="overallEvaluation" rows="6" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请对企业的整体状况、授信风险等进行总体评价"></textarea>
                            </div>
                            <div>
                                <div class="flex justify-between items-center mb-2">
                                    <label class="text-sm font-medium text-gray-700">5.2 授信建议</label>
                                    <button class="ai-generate-btn text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1" data-field="creditSuggestion">
                                        <i class="fa fa-magic"></i> AI生成
                                    </button>
                                </div>
                                <textarea id="creditSuggestion" rows="4" class="w-full px-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all resize-none" placeholder="请提出授信额度、期限、利率、担保方式等具体建议"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8 flex justify-between">
                        <button id="backToStep2Btn" class="px-6 py-3 rounded-xl font-semibold text-gray-600 hover:bg-gray-100 transition-colors flex items-center gap-2">
                            <i class="fa fa-arrow-left"></i>
                            <span>上一步</span>
                        </button>
                        <div class="flex gap-3">
                            <button id="aiGenerateAllBtn" class="px-6 py-3 rounded-xl font-semibold text-primary-600 border-2 border-primary-500 hover:bg-primary-50 transition-colors flex items-center gap-2">
                                <i class="fa fa-magic"></i>
                                <span>AI智能生成全部</span>
                            </button>
                            <button id="toStep4Btn" class="btn-primary text-white px-8 py-3 rounded-xl font-semibold flex items-center gap-2">
                                <span>下一步：生成报告</span>
                                <i class="fa fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Generate Report -->
            <div id="step4-content" class="step-content">
                <div class="glass rounded-2xl p-8 shadow-xl">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-2">生成授信报告</h2>
                        <p class="text-gray-500">确认信息无误后，点击"生成报告"按钮生成最终的授信报告文档</p>
                    </div>
                    
                    <!-- Generation Options -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <i class="fa fa-cogs text-primary-500"></i>
                            生成选项
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">报告格式</label>
                                <select id="reportFormat" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all">
                                    <option value="docx">Word文档 (.docx)</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-600 mb-1">报告标题</label>
                                <input type="text" id="reportTitle" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" value="企业授信调查报告">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Report Preview -->
                    <div class="mb-8">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                            <i class="fa fa-eye text-primary-500"></i>
                            报告预览
                        </h3>
                        <div id="reportPreview" class="border border-gray-200 rounded-xl p-6 h-80 overflow-y-auto bg-white">
                            <div class="text-center text-gray-400 py-12">
                                <i class="fa fa-file-text-o text-5xl mb-4"></i>
                                <p>点击"生成报告"按钮后将显示报告预览</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Generation Result -->
                    <div id="generationResult" class="hidden mb-8">
                        <div class="bg-green-50 border border-green-200 rounded-xl p-6">
                            <div class="flex items-start gap-4">
                                <div class="w-12 h-12 rounded-full bg-success flex items-center justify-center flex-shrink-0">
                                    <i class="fa fa-check text-white text-xl"></i>
                                </div>
                                <div>
                                    <h4 class="text-lg font-semibold text-gray-800 mb-1">报告生成成功</h4>
                                    <p class="text-gray-600 mb-4">您的授信报告已成功生成，请点击下方按钮下载</p>
                                    <button id="downloadReportBtn" class="btn-primary text-white px-6 py-2 rounded-lg font-medium flex items-center gap-2">
                                        <i class="fa fa-download"></i>
                                        <span>下载报告</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between">
                        <button id="backToStep3Btn" class="px-6 py-3 rounded-xl font-semibold text-gray-600 hover:bg-gray-100 transition-colors flex items-center gap-2">
                            <i class="fa fa-arrow-left"></i>
                            <span>上一步</span>
                        </button>
                        <div class="flex gap-3">
                            <button id="generateReportBtn" class="btn-primary text-white px-8 py-3 rounded-xl font-semibold flex items-center gap-2">
                                <i class="fa fa-file-text-o"></i>
                                <span>生成报告</span>
                            </button>
                            <button id="restartBtn" class="px-6 py-3 rounded-xl font-semibold text-gray-600 border border-gray-300 hover:bg-gray-100 transition-colors flex items-center gap-2">
                                <i class="fa fa-refresh"></i>
                                <span>重新开始</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center">
                <h3 class="text-lg font-bold text-gray-800">API 设置</h3>
                <button id="closeSettingsBtn" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6 space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">DeepSeek API Key</label>
                    <input type="password" id="deepseekApiKey" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入 DeepSeek API Key">
                    <p class="mt-1 text-xs text-gray-500">用于文本分析和内容生成</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">SiliconFlow API Key</label>
                    <input type="password" id="siliconflowApiKey" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" placeholder="请输入 SiliconFlow API Key">
                    <p class="mt-1 text-xs text-gray-500">用于OCR图像识别</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">代理服务器地址</label>
                    <input type="text" id="proxyServer" class="w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all" value="http://localhost:3000" placeholder="http://localhost:3000">
                    <p class="mt-1 text-xs text-gray-500">本地代理服务器地址</p>
                </div>
            </div>
            <div class="px-6 py-4 bg-gray-50 flex justify-end gap-3">
                <button id="cancelSettingsBtn" class="px-4 py-2 rounded-lg text-gray-600 hover:bg-gray-200 transition-colors">取消</button>
                <button id="saveSettingsBtn" class="btn-primary text-white px-4 py-2 rounded-lg">保存设置</button>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="helpModal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden">
            <div class="px-6 py-4 border-b border-gray-100 flex justify-between items-center">
                <h3 class="text-lg font-bold text-gray-800">使用帮助</h3>
                <button id="closeHelpBtn" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6 overflow-y-auto max-h-[60vh] space-y-6">
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">系统介绍</h4>
                    <p class="text-gray-600 text-sm">智银派授信报告智能填写系统是一款利用AI技术自动生成授信报告的工具，可以从上传的材料中自动提取信息并生成专业的授信报告。</p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">使用流程</h4>
                    <ol class="list-decimal list-inside text-gray-600 text-sm space-y-2">
                        <li><strong>上传材料</strong>：上传授信报告模板（Word文档）、财务报表（Excel）和工商信息截图</li>
                        <li><strong>信息确认</strong>：确认从上传材料中提取的企业基本信息和财务数据</li>
                        <li><strong>文本填写</strong>：填写或使用AI生成授信报告的详细文本内容</li>
                        <li><strong>生成报告</strong>：生成并下载最终的授信报告文档</li>
                    </ol>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">API配置</h4>
                    <p class="text-gray-600 text-sm mb-2">使用本系统需要配置以下API密钥：</p>
                    <ul class="list-disc list-inside text-gray-600 text-sm space-y-1">
                        <li><strong>DeepSeek API Key</strong>：用于文本分析和AI内容生成 (获取: platform.deepseek.com)</li>
                        <li><strong>SiliconFlow API Key</strong>：用于OCR图像识别 (获取: cloud.siliconflow.cn)</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center">
        <div class="bg-white rounded-2xl p-8 shadow-2xl max-w-sm w-full mx-4 text-center">
            <div class="spinner mx-auto mb-4"></div>
            <p id="loadingText" class="text-gray-700 font-medium">处理中...</p>
            <div class="mt-4 w-full h-2 bg-gray-200 rounded-full overflow-hidden">
                <div id="loadingProgress" class="h-full bg-gradient-to-r from-primary-500 to-accent-500 progress-fill" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files -->
    <script src="js/apiService.js"></script>
    <script src="js/fileParser.js"></script>
    <script src="js/templateEngine.js"></script>
    <script src="js/uiController.js"></script>
    <script src="js/app.js"></script>
</body>
</html>


